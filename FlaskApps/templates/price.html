<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>ë†ì‚°ë¬¼ ê°€ê²© ë¹„êµ</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="icon" href="./static/picture/apple_icon.ico" />
    <style>
        .chart-box { width: 400px; margin-bottom: 50px; }
        .comment { margin-top: 10px; font-weight: bold; }
    </style>
</head>
<body>
    <h1>ğŸ“Š ë†ì‚°ë¬¼ ê°€ê²© ë¹„êµ</h1>
    {% for item, data in results.items() %}
        <div class="chart-box">
            <h2>{{ item }}</h2>

            {% if data %}
                <canvas id="chart_{{ loop.index }}"></canvas>
                <div class="comment">
                    í‰ë…„ ëŒ€ë¹„ {{ data.percent.í‰ë…„ | abs }}%
                    {{ 'ë¹„ìŒ‰ë‹ˆë‹¤' if data.percent.í‰ë…„ > 0 else 'ìŒ‰ë‹ˆë‹¤' }}.<br>
                    1ì£¼ì¼ ì „ ëŒ€ë¹„ {{ data.percent["1ì£¼ì¼ì „"] | abs }}%
                    {{ 'ë¹„ìŒ‰ë‹ˆë‹¤' if data.percent["1ì£¼ì¼ì „"] > 0 else 'ìŒ‰ë‹ˆë‹¤' }}.
                </div>
                <script>
                    const ctx{{ loop.index }} = document.getElementById("chart_{{ loop.index }}").getContext('2d');
                    new Chart(ctx{{ loop.index }}, {
                        type: 'bar',
                        data: {
                            labels: ['í‰ë…„', '1ì£¼ì¼ì „', 'ì˜¤ëŠ˜'],
                            datasets: [{
                                label: 'ê°€ê²© (ì›)',
                                data: [
                                    {{ data.prices.í‰ë…„ }},
                                    {{ data.prices["1ì£¼ì¼ì „"] }},
                                    {{ data.prices.ì˜¤ëŠ˜ }}
                                ],
                                backgroundColor: ['#a3d2ca', '#5eaaa8', '#056676']
                            }]
                        },
                        options: {
                            plugins: {
                                legend: { display: false },
                                tooltip: { enabled: true },
                                datalabels: {
                                    anchor: 'end',
                                    align: 'end',
                                    formatter: function(value) {
                                        return value + 'ì›';
                                    }
                                }
                            },
                            scales: {
                                y: {
                                    beginAtZero: true,
                                    title: {
                                        display: true,
                                        text: 'ê°€ê²© (ì›)'
                                    }
                                }
                            }
                        }
                    });
                </script>
            {% else %}
                <p>ì•„ì§ ìˆ˜í™•ì² ì´ ì•„ë‹ˆì—ìš©~ ğŸ˜¢</p>
            {% endif %}
        </div>
    {% endfor %}
</body>
</html>